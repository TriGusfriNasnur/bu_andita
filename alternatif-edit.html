<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tri Gusfri Nasnur</title>

  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/bootstrap.css">
  <link rel="stylesheet" href="assets/vendors/iconly/bold.css">
  <link rel="stylesheet" href="assets/vendors/perfect-scrollbar/perfect-scrollbar.css">
  <link rel="stylesheet" href="assets/vendors/bootstrap-icons/bootstrap-icons.css">
  <link rel="stylesheet" href="assets/css/app.css">
  <link rel="shortcut icon" href="assets/images/favicon.png" type="image/x-icon">
</head>

<body>
<div id="app">

<!-- ===== SIDEBAR (TIDAK DIUBAH) ===== -->
<div id="sidebar" class="active">
  <div class="sidebar-wrapper active">
    <div class="sidebar-header">
      <div class="d-flex justify-content-between">
        <div class="logo">
          <a href="./">Al Ihsan <p>Al Islamy</p></a>
        </div>
        <div class="toggler">
          <a href="#" class="sidebar-hide d-xl-none d-block">
            <i class="bi bi-x bi-middle"></i>
          </a>
        </div>
      </div>
    </div>

    <div class="sidebar-menu">
      <ul class="menu">
        <li class="sidebar-title">Menu</li>

        <li class="sidebar-item">
          <a href="./" class="sidebar-link">
            <i class="bi bi-grid-fill"></i>
            <span>Beranda</span>
          </a>
        </li>

        <li class="sidebar-item has-sub">
          <a href="#" class="sidebar-link">
            <i class="bi bi-file-earmark-spreadsheet-fill"></i>
            <span>Karyawan & Kriteria</span>
          </a>
          <ul class="submenu">
            <li class="submenu-item">
              <a href="alternatif.html">Karyawan</a>
            </li>
            <li class="submenu-item">
              <a href="bobot.html">Kriteria</a>
            </li>
          </ul>
        </li>

        <li class="sidebar-item">
          <a href="matrik.html" class="sidebar-link">
            <i class="bi bi-pentagon-fill"></i>
            <span>Perhitungan</span>
          </a>
        </li>

        <li class="sidebar-item">
          <a href="preferensi.html" class="sidebar-link">
            <i class="bi bi-bar-chart-fill"></i>
            <span>Peringkat</span>
          </a>
        </li>

        <li class="sidebar-item">
          <a href="logout.html" class="sidebar-link">
            <i class="bi bi-box-arrow-right"></i>
            <span>Keluar</span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>
<!-- ===== END SIDEBAR ===== -->

<div id="main">
<header class="mb-3">
  <a href="#" class="burger-btn d-block d-xl-none">
    <i class="bi bi-justify fs-3"></i>
  </a>
</header>

<div class="page-heading">
  <h3>Karyawan</h3>
</div>

<div class="page-content">
<section class="row">
<div class="card">

  <div class="card-header">
    <h4 class="card-title">Edit Karyawan</h4>
    <p id="message" class="text-danger"></p>
  </div>

  <div class="card-body">
    <div class="form-group">
      <label>Nama</label>
      <input type="hidden" id="editId">
      <input type="text" id="editName" class="form-control">
    </div>

    <div class="form-group mt-3">
      <button type="button" class="btn btn-info btn-sm" onclick="saveChanges()">
        Selesai
      </button>
    </div>
  </div>

</div>
</section>
</div>

<footer>
  <div class="footer clearfix mb-0 text-muted">
    <div class="float-start">
      <p>Karyawan Terbaik &copy; Simple Additive Weighting</p>
    </div>
    <div class="float-end">
      <p>Al Ihsan Al Islamy <i class="bi bi-heart text-danger"></i> Tri Gusfri Nasnur</p>
    </div>
  </div>
</footer>

</div>
</div>

<!-- ===== JS ===== -->
<script src="assets/vendors/perfect-scrollbar/perfect-scrollbar.min.js"></script>
<script src="assets/js/bootstrap.bundle.min.js"></script>
<script src="assets/js/main.js"></script>

<script>
const token = localStorage.getItem('token');
const message = document.getElementById('message');
const id = new URLSearchParams(window.location.search).get('id');

if (!token) {
  window.location.href = 'login.html';
}

if (!id) {
  message.textContent = 'ID karyawan tidak ditemukan';
  throw new Error('ID kosong');
}

function fetchAlternatif() {
  fetch(`http://localhost:3000/api/alternatif/${id_alternative}`, {
    headers: {
      Authorization: 'Bearer ' + token
    }
  })

  /*===========================================
  
                  NOTIF EDIT DATA
  
  =============================================*/
  .then(res => {
    if (!res.ok) throw new Error('Gagal mengambil data karyawan');
    return res.json();
  })
  .then(data => {
    document.getElementById('editId').value = data.id_alternative;
    document.getElementById('editName').value = data.name;
  })
  .catch(err => {
    message.textContent = err.message;
  });
}

function saveChanges() {
  const name = document.getElementById('editName').value;

  fetch(`http://localhost:3000/api/alternatif/${id}`, {
    method: 'PUT',
    headers: {
      'Content-Type': 'application/json',
      Authorization: 'Bearer ' + token
    },
    body: JSON.stringify({ name })
  })
  .then(res => {
    if (!res.ok) throw new Error('Gagal update data');
    window.location.href = 'alternatif.html';
  })
  .catch(err => alert(err.message));
}

fetchAlternatif();
</script>

</body>
</html>